---
title: MEAN Stack으로 구현하기 (1)
author: interp
type: post
date: 2020-02-01T23:36:08+00:00
draft: true
private: true
url: /mean-stack으로-구현하기-1/
categories:
  - 미분류
tags:
  - postgres
  - heroku
  - node.js

---
### 준비

  1. 우선 [Github][1] 에 Repository 를 하나 만든다.
  2. 그 다음 `npm init` 을 통해 `package.json` 파일을 만든다.
  3. 필요한 모듈을 설치한다. <pre class="brush: bash; title: ; notranslate" title="">npm install express body-parser mysql --save --save-exact
</pre>
    
      1. Express 는 당연히 필요하다.
      2. Body-Parser 역시 `req.body`로 파싱해서 받으려면 필요하다.
      3. MySQL을 사용할 거라서 Mongoose 말고 mysql 모듈을 깔아야 한다.
      4. `--save --save-exact` 의 의미는 &#8216;package.json에 dependencies 를 기록하고, 모듈 이름 뿐만 아니라 설치할 모듈의 버전까지 확실히 기록하라&#8217;는 것이다.

### NodeJS 작성

`package.json` 에서 정의한 메인 파일 (`index.js`)을 작성한다. 파일을 나눠 놓으면 좋겠지만, 초보에게 많은 걸 기대하지는 말자.

참고로 에디터는 atom을 사용했고, nodejs-snippet 과 angularjs 패키지를 설치해서 생산성을 손톱만큼 높였다! (snippet 종류를 전부 훓어보지도 않았다&#8230;)

  1. Express, Body-Parser, MySQL 을 `require`로 불러온다.
  2. Express app에 Body-Parser의 urlencoded, json 을 사용하도록 한다.
  3. Root에 라우팅할 코드를 간단히 집어넣는다. (Hello World! 가 가장 만만하다)

### Heroku Database

무료로 사용할 것 중에 가장 만만한게 MySQL이 아니라 Postgres 이어서, 이걸 대신한다.

  1. Heroku Add-on 에서 [Heroku Postgres][2] 를 설치한다. 테스트를 위해서, Hobby-dev Plan (즉, 공짜 플랜)을 선택해서 설치한다. 데이터 7.5MB, Record 건수 1만건의 제한이 걸려있다.
  2. postgreSQL을 설치한다. psql 클라이언트를 사용하기 위해서이니, 클라이언트만 설치할 수 있다면 그래도 된다.
  3. `heroku pg:psql` 로 접속해서 스키마를 생성한다.
  4. [여기 Node.js 를 통해 접속하는 방법][3]을 참고해서 접속 코드를 작성한다.
  
    이 때 `pg` 라는 모듈이 필요하므로 설치해야 한다. (서비스를 통해서 데이터베이스를 헤집지 못하도록, 특정 권한을 가진 사용자를 생성해서 운용하는 것이 좋다.)

#### Postgres in Local Machine

로컬에서 Heroku Postgres에 접속하는 건 느리기도 하고 설정이 귀찮기도 하다. 그냥 로컬에도 Postgres 서버를 두는 것이 속 편한(?) 방법일 수 있다. 이것도 결코 간단하진 않아서 문제긴 하지만.

<pre class="brush: bash; title: ; notranslate" title="">sudo su - postgres
psql
</pre>

방법은 Debian/Ubuntu 계열로 설명했지만 어쨌거나 관리자 권한을 통해 postgres 계정으로 접속해서 `psql`을 실행한 다음에 아래 SQL을 실행한다.

<pre class="brush: sql; title: ; notranslate" title="">create role 'username';
alter role 'username' superuser;

-- 혹시나 이래도 'not permitted to log in' 같은 에러가 나면
alter role 'username' with login;

-- 'postgres' 데이터베이스가 아닌 username의 데이터베이스를 쓰고 싶다면
create database 'username';
</pre>

이 때 세미콜론을 반드시 찍어야 한다. 엔터를 그냥 누르면 Multi-line SQL로 인식하고 입력을 계속 받기 때문에, 사용자가 알기 힘들다. (=기호가 -기호로 바뀌긴 한다) 이러고 나서 본인 계정으로 되돌아와 `psql postgres` 라고 입력하면, 정상 접속이 가능하다.

### Input에 통화 기호 표시하기

아무리 생각해도 CSS Trick 으로 해결하는 게 가장 간단해 보인다. [여기][4] JSfiddle을 참고하자. 여기서 right 부분을 모두 left 바꾸면 원하는 대로 나온다.

 [1]: http://github.com
 [2]: https://elements.heroku.com/addons/heroku-postgresql
 [3]: https://devcenter.heroku.com/articles/heroku-postgresql#connecting-in-node-js
 [4]: https://jsfiddle.net/x4tek1ro/5/