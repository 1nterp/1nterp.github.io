<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Gitlab 삽질기 | InterP Blog</title>
<meta name=keywords content="gitlab,ci">
<meta name=description content="Upgrade 8.x 로 쓰다가 10.x 로 업그레이드를 진행했다. 아니.. 그런데 Postgresql Database 버전이 다르다고? 알고보니 이렇게 대격변을 일으키면 안 되던 거였다. 그래서 겸사겸사 9.5.10 으로 다시 설치하니까 된다.
 gitlab-ctl reconfigure 를 설치 직후에 반드시 해 줘야 한다. 가끔 gitlab-ctl pg-upgrade 를 꼭 하라는 말이 있던데, 내가 해보니까 gitlab-ctl reconfigure 할 때 알아서 한다 (…) 했던 거 또 하는 느낌. gitlab-ctl restart 를 할 때 postgresql 이나 다른 곳에서 &lsquo;down, up, want up&rsquo; 이런 게 뜨면 서비스가 온전히 수행될 수 없는 상황이다.">
<meta name=author content="interp">
<link rel=canonical href=https://interp.blog/gitlab-%EC%82%BD%EC%A7%88%EA%B8%B0/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.9906a2b74cdafd3190ad7dbbc2fccdff9c2aaff204038b3d609a6041a2d43a49.css integrity="sha256-mQait0za/TGQrX27wvzN/5wqr/IEA4s9YJpgQaLUOkk=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://interp.blog/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://interp.blog/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://interp.blog/favicon-32x32.png>
<link rel=apple-touch-icon href=https://interp.blog/apple-touch-icon.png>
<link rel=mask-icon href=https://interp.blog/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.91.2">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="Gitlab 삽질기">
<meta property="og:description" content="Upgrade 8.x 로 쓰다가 10.x 로 업그레이드를 진행했다. 아니.. 그런데 Postgresql Database 버전이 다르다고? 알고보니 이렇게 대격변을 일으키면 안 되던 거였다. 그래서 겸사겸사 9.5.10 으로 다시 설치하니까 된다.
 gitlab-ctl reconfigure 를 설치 직후에 반드시 해 줘야 한다. 가끔 gitlab-ctl pg-upgrade 를 꼭 하라는 말이 있던데, 내가 해보니까 gitlab-ctl reconfigure 할 때 알아서 한다 (…) 했던 거 또 하는 느낌. gitlab-ctl restart 를 할 때 postgresql 이나 다른 곳에서 &lsquo;down, up, want up&rsquo; 이런 게 뜨면 서비스가 온전히 수행될 수 없는 상황이다.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://interp.blog/gitlab-%EC%82%BD%EC%A7%88%EA%B8%B0/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-11-15T09:17:58+00:00">
<meta property="article:modified_time" content="2017-11-15T09:17:58+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Gitlab 삽질기">
<meta name=twitter:description content="Upgrade 8.x 로 쓰다가 10.x 로 업그레이드를 진행했다. 아니.. 그런데 Postgresql Database 버전이 다르다고? 알고보니 이렇게 대격변을 일으키면 안 되던 거였다. 그래서 겸사겸사 9.5.10 으로 다시 설치하니까 된다.
 gitlab-ctl reconfigure 를 설치 직후에 반드시 해 줘야 한다. 가끔 gitlab-ctl pg-upgrade 를 꼭 하라는 말이 있던데, 내가 해보니까 gitlab-ctl reconfigure 할 때 알아서 한다 (…) 했던 거 또 하는 느낌. gitlab-ctl restart 를 할 때 postgresql 이나 다른 곳에서 &lsquo;down, up, want up&rsquo; 이런 게 뜨면 서비스가 온전히 수행될 수 없는 상황이다.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://interp.blog/posts/"},{"@type":"ListItem","position":2,"name":"Gitlab 삽질기","item":"https://interp.blog/gitlab-%EC%82%BD%EC%A7%88%EA%B8%B0/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Gitlab 삽질기","name":"Gitlab 삽질기","description":"Upgrade 8.x 로 쓰다가 10.x 로 업그레이드를 진행했다. 아니.. 그런데 Postgresql Database 버전이 다르다고? 알고보니 이렇게 대격변을 일으키면 안 되던 거였다. 그래서 겸사겸사 9.5.10 으로 다시 설치하니까 된다.\n gitlab-ctl reconfigure 를 설치 직후에 반드시 해 줘야 한다. 가끔 gitlab-ctl pg-upgrade 를 꼭 하라는 말이 있던데, 내가 해보니까 gitlab-ctl reconfigure 할 때 알아서 한다 (…) 했던 거 또 하는 느낌. gitlab-ctl restart 를 할 때 postgresql 이나 다른 곳에서 \u0026lsquo;down, up, want up\u0026rsquo; 이런 게 뜨면 서비스가 온전히 수행될 수 없는 상황이다.","keywords":["gitlab","ci"],"articleBody":"Upgrade 8.x 로 쓰다가 10.x 로 업그레이드를 진행했다. 아니.. 그런데 Postgresql Database 버전이 다르다고? 알고보니 이렇게 대격변을 일으키면 안 되던 거였다. 그래서 겸사겸사 9.5.10 으로 다시 설치하니까 된다.\n gitlab-ctl reconfigure 를 설치 직후에 반드시 해 줘야 한다. 가끔 gitlab-ctl pg-upgrade 를 꼭 하라는 말이 있던데, 내가 해보니까 gitlab-ctl reconfigure 할 때 알아서 한다 (…) 했던 거 또 하는 느낌. gitlab-ctl restart 를 할 때 postgresql 이나 다른 곳에서 ‘down, up, want up’ 이런 게 뜨면 서비스가 온전히 수행될 수 없는 상황이다. gitlab-ctl tail 을 실행시켜 로그를 뒤져봐야 한다. 에러가 났거나, 무한히 반복되는 메시지가 없는지 확인하자.  Runner 우리 회사 Gitlab 구조는 웹 서비스 주소와 내부 공유 주소가 다르다. (도메인을 거의 리다이렉트 비슷하게 해놨기 때문이기도 하지만) 비공개 저장소다 보니, 웹 접속은 외부에서 되었면서 Clone 은 똑같은 주소로 절대 받을 수 없게 해 놨다. 이게 Gitlab Runner 를 바보로 만들었다 (…)\nGitlab Runner는 .gitlab-ci.yml 의 구성에 상관없이, 선작업으로 해당 저장소를 Cloning 하거나 Fetching 하게 된다. (양자택일은 웹 페이지의 Runner 관리 페이지에서 설정이 가능하다.) 이건 Runner의 Executer를 Docker를 하던 Shell 을 하던 똑같다. 문제는 내가 언급했던 대로, 이 저장소 주소를 웹 주소에 기반해서 가져가기 때문에, 항상 실패했다는 것이다.\n짜증이 치밀 즈음, 아예 이 작업을 끌 수는 없을까 하고 봤더니… 역시나 답은 있었다.\n이렇게 두면, Runner의 옵션을 Cloning 으로 줬건 Fetching 으로 줬건 간에 하지 않는다.\n즉, 모든 작업을 온전히 CI 명령에 맡기는 것이다. 위험하기도 하고, 캐싱도 안 되고 약점이 많지만, 나는 상관이 없었다. 직접 내부 주소의 저장소로 접근해서 받아오면 그만!\nRepository 에 SSH Key 등록 그런데, 문제가 생겼다. 아래와 같이 ‘gitlab-runner’ 사용자로 Runner Service를 등록하고, 실행시켰다고 가정하자.\n나는 Executer를 Shell 로 쓰고 있는데, 이 친구가 내부 저장소로 (그것도 SSH 주소로) 접근하려면… SSH Public Key를 넣어줘야 된다. 넣지 않으면 인증에서 실패한다. 그런데 Gitlab Runner 의 Shell 사용자는 위에서 보이는 것 처럼 ‘gitlab-runner’ 인데.. 얘는 Gitlab 계정도 없는 가상 사용자다. 어떻게 Public Key를 등록할까?\nGitlab은, 각 사용자 계정의 SSH Public Key를 관리해 주기도 하지만 Project 별로 SSH Key를 등록할 수도 있다. Project 페이지의 Settings  Repository 에서 Deploy Keys 부분을 펼쳐보자. 그러면 익숙한 SSH Key 등록 폼이 나온다. 여기에, 아까 언급한 ‘gitlab-runner’ 의 SSH Key를 등록하면 된다. (당연히 gitlab-runner 계정에서 SSH Key 생성을 해야한다.)\n그러면.gitlab-ci.yml 에 마구잡이로 'git clone git@~~~~:/.git' 이런 식으로 스크립트를 적어도 아주 잘 clone 되는 걸 확인할 수 있다!\nCreate New Branch 의 기본 Branch 바꾸기 Issue에서 Create New Branch (9.x 에서는 New Branch) 를 하면, Branch의 이름이 ‘421 – invalid table error’ 이런 식으로 뜬다. 이슈 번호와 이슈 제목.\n그런데 내부적으로는 이슈 제목에 한글을 많이 써서 Branch 이름을 출력하고 싶지 않았다. 그리고 규격화된 이름 (ISSUE#XXXX) 으로 Branch를 생성하고픈 욕구가 치밀었다. (참고로 Push Rule 에서 Branch Naming Rule에 저렇게 규칙을 쓰고, Create New Branch 를 누르면 절대로 Branch가 생기지 않는다.)\nGitlab에 이미 #21143 으로 이슈가 등록되었고, 10.3 에서 업데이트가 된다지만… 이렇게 되면 사용자가 매번 Push Rule을 피하려고 Branch 이름을 일일이 쳐넣는 어처구니없는 상황이 계속된다. 그래서 코드를 찾아내서 고치는 편이 낫다고 생각했다.\nRuby는 쥐뿔도 모르지만 코드는 코드일 뿐.\n이슈에 대한 브랜치를 생성하는 작업은 이 Merge Request 에서 반영된 것이다. 여기 Diff를 쭉 봤더니 to_branch_name 이 눈에 띈다. 오호라. 하지만 어디서 수정해야 할까?\nGitlab을 Omnibus 로 정직하게 설치했다면 소스코드 경로는 /opt/gitlab/embedded/service/gitlab-rails/ 에 있다. 여기서 grep으로 to_branch_name 을 검색해 보면?\n여기서 \"#{iid}-#{title.parameterize}\" 라고 정의된 부분을 적절히 바꿔주자. 나는 \"ISSUE##{iid}\" 로 심플하게 바꿨다.\n이것만 바꾸면 ‘Create New Branch’ 를 누를 때 잘 될 것 같다. 하지만 Issue 페이지에서 ‘연관된 Issue Branch’ 목록에 연결되지 않는다. 수정한 파일 /opt/gitlab/embedded/service/gitlab-rails/app/models/issue.rb 에서, 더 수정할 것이 남아있다. 다음 함수를 수정해야 한다.\n has_related_branch related_branches  수정 방법은 간단한데, Branch와 비교하는 Regular Expression 의 문법을 찾아보자. /\\A${iid}-(?!\\d+-stable)/i 라고 되어 있을 것이다. 이걸 실제로 irb 에서 테스트해 보면, 420-title 같은 건 되는데 420-0-stable 은 인식이 안 되는 것을 알 수 있다. (뭔가.. 이상하다) 아무튼 이걸 적절한 Regular Expression 으로 바꿔 주도록 하자. Ruby의 Regexp 에 익숙치 않다면 이 사이트의 도움을 받아보도록 하자. (내 경우는 간단하게 /\\AISSUE#{iid}/i 라고 했다.)\n수정을 했다. 하지만 끝이 아니다. 마무리를 해 줘야 한다. 실제 Gitlab이 서비스되고 있는 경로는 /var/opt/gitlab 이므로, 해당 경로로 적용을 시켜줘야 한다. 어떻게?\n간단하다. gitlab-ctl reconfigure \u0026\u0026 gitlab-ctl restart 를 입력하자.\n ","wordCount":"654","inLanguage":"en","datePublished":"2017-11-15T09:17:58Z","dateModified":"2017-11-15T09:17:58Z","author":{"@type":"Person","name":"interp"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://interp.blog/gitlab-%EC%82%BD%EC%A7%88%EA%B8%B0/"},"publisher":{"@type":"Organization","name":"InterP Blog","logo":{"@type":"ImageObject","url":"https://interp.blog/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://interp.blog/ accesskey=h title="InterP Blog (Alt + H)">InterP Blog</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://interp.blog/posts/ title=Posts>
<span>Posts</span>
</a>
</li>
<li>
<a href=https://interp.blog/archives/ title=Archives>
<span>Archives</span>
</a>
</li>
<li>
<a href=https://interp.blog/search/ title=Search>
<span>Search</span>
</a>
</li>
<li>
<a href=https://interp.blog/drafts/ title=Drafts>
<span>Drafts</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://interp.blog/>Home</a>&nbsp;»&nbsp;<a href=https://interp.blog/posts/>Posts</a></div>
<h1 class=post-title>
Gitlab 삽질기
</h1>
<div class=post-meta><span title="2017-11-15 09:17:58 +0000 UTC">November 15, 2017</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;interp
</div>
</header>
<div class=post-content><h3 id=upgrade>Upgrade<a hidden class=anchor aria-hidden=true href=#upgrade>#</a></h3>
<p>8.x 로 쓰다가 10.x 로 업그레이드를 진행했다. 아니.. 그런데 Postgresql Database 버전이 다르다고? 알고보니 이렇게 대격변을 일으키면 안 되던 거였다. 그래서 겸사겸사 9.5.10 으로 다시 설치하니까 된다.</p>
<ul>
<li><code>gitlab-ctl reconfigure</code> 를 설치 직후에 반드시 해 줘야 한다.</li>
<li>가끔 <code>gitlab-ctl pg-upgrade</code> 를 꼭 하라는 말이 있던데, 내가 해보니까 <code>gitlab-ctl reconfigure</code> 할 때 알아서 한다 (…) 했던 거 또 하는 느낌.</li>
<li><code>gitlab-ctl restart</code> 를 할 때 postgresql 이나 다른 곳에서 &lsquo;down, up, want up&rsquo; 이런 게 뜨면 서비스가 온전히 수행될 수 없는 상황이다. <code>gitlab-ctl tail</code> 을 실행시켜 로그를 뒤져봐야 한다. 에러가 났거나, 무한히 반복되는 메시지가 없는지 확인하자.</li>
</ul>
<h3 id=runner>Runner<a hidden class=anchor aria-hidden=true href=#runner>#</a></h3>
<p>우리 회사 Gitlab 구조는 웹 서비스 주소와 내부 공유 주소가 다르다. (도메인을 거의 리다이렉트 비슷하게 해놨기 때문이기도 하지만) 비공개 저장소다 보니, 웹 접속은 외부에서 되었면서 Clone 은 똑같은 주소로 절대 받을 수 없게 해 놨다. 이게 Gitlab Runner 를 바보로 만들었다 (…)</p>
<p>Gitlab Runner는 <code>.gitlab-ci.yml</code> 의 구성에 상관없이, 선작업으로 해당 저장소를 Cloning 하거나 Fetching 하게 된다. (양자택일은 웹 페이지의 Runner 관리 페이지에서 설정이 가능하다.) 이건 Runner의 Executer를 Docker를 하던 Shell 을 하던 똑같다. 문제는 내가 언급했던 대로, 이 저장소 주소를 웹 주소에 기반해서 가져가기 때문에, 항상 실패했다는 것이다.</p>
<p>짜증이 치밀 즈음, 아예 이 작업을 끌 수는 없을까 하고 봤더니… 역시나 답은 있었다.</p>
<p>이렇게 두면, Runner의 옵션을 Cloning 으로 줬건 Fetching 으로 줬건 간에 <strong>하지 않는다</strong>.</p>
<p>즉, 모든 작업을 온전히 CI 명령에 맡기는 것이다. 위험하기도 하고, 캐싱도 안 되고 약점이 많지만, 나는 상관이 없었다. 직접 내부 주소의 저장소로 접근해서 받아오면 그만!</p>
<h3 id=repository-에-ssh-key-등록>Repository 에 SSH Key 등록<a hidden class=anchor aria-hidden=true href=#repository-에-ssh-key-등록>#</a></h3>
<p>그런데, 문제가 생겼다. 아래와 같이 &lsquo;gitlab-runner&rsquo; 사용자로 Runner Service를 등록하고, 실행시켰다고 가정하자.</p>
<p>나는 Executer를 Shell 로 쓰고 있는데, 이 친구가 내부 저장소로 (그것도 SSH 주소로) 접근하려면… SSH Public Key를 넣어줘야 된다. 넣지 않으면 인증에서 실패한다. 그런데 Gitlab Runner 의 Shell 사용자는 위에서 보이는 것 처럼 &lsquo;gitlab-runner&rsquo; 인데.. 얘는 Gitlab 계정도 없는 가상 사용자다. 어떻게 Public Key를 등록할까?</p>
<p>Gitlab은, 각 사용자 계정의 SSH Public Key를 관리해 주기도 하지만 Project 별로 SSH Key를 등록할 수도 있다. <em>Project 페이지의 Settings > Repository</em> 에서 Deploy Keys 부분을 펼쳐보자. 그러면 익숙한 SSH Key 등록 폼이 나온다. 여기에, 아까 언급한 &lsquo;gitlab-runner&rsquo; 의 SSH Key를 등록하면 된다. (당연히 gitlab-runner 계정에서 SSH Key 생성을 해야한다.)</p>
<p>그러면<code>.gitlab-ci.yml</code> 에 마구잡이로 <code>'git clone git@~~~~:&lt;user or group>/&lt;project>.git'</code> 이런 식으로 스크립트를 적어도 아주 잘 clone 되는 걸 확인할 수 있다!</p>
<h3 id=create-new-branch-의-기본-branch-바꾸기>Create New Branch 의 기본 Branch 바꾸기<a hidden class=anchor aria-hidden=true href=#create-new-branch-의-기본-branch-바꾸기>#</a></h3>
<p>Issue에서 Create New Branch (9.x 에서는 New Branch) 를 하면, Branch의 이름이 &lsquo;421 – invalid table error&rsquo; 이런 식으로 뜬다. 이슈 번호와 이슈 제목.</p>
<p>그런데 내부적으로는 이슈 제목에 한글을 많이 써서 Branch 이름을 출력하고 싶지 않았다. 그리고 규격화된 이름 (ISSUE#XXXX) 으로 Branch를 생성하고픈 욕구가 치밀었다. (참고로 Push Rule 에서 Branch Naming Rule에 저렇게 규칙을 쓰고, Create New Branch 를 누르면 절대로 Branch가 생기지 않는다.)</p>
<p>Gitlab에 이미 <a href=https://gitlab.com/gitlab-org/gitlab-ce/issues/21143>#21143</a> 으로 이슈가 등록되었고, 10.3 에서 업데이트가 된다지만… 이렇게 되면 사용자가 매번 Push Rule을 피하려고 Branch 이름을 일일이 쳐넣는 어처구니없는 상황이 계속된다. 그래서 코드를 찾아내서 고치는 편이 낫다고 생각했다.</p>
<p>Ruby는 쥐뿔도 모르지만 코드는 코드일 뿐.</p>
<p>이슈에 대한 브랜치를 생성하는 작업은 <a href=https://gitlab.com/gitlab-org/gitlab-ce/merge_requests/2808/diffs>이 Merge Request</a> 에서 반영된 것이다. 여기 Diff를 쭉 봤더니 <code>to_branch_name</code> 이 눈에 띈다. 오호라. 하지만 어디서 수정해야 할까?</p>
<p>Gitlab을 Omnibus 로 정직하게 설치했다면 소스코드 경로는 <code>/opt/gitlab/embedded/service/gitlab-rails/</code> 에 있다. 여기서 grep으로 <code>to_branch_name</code> 을 검색해 보면?</p>
<p>여기서 <code>"#{iid}-#{title.parameterize}"</code> 라고 정의된 부분을 적절히 바꿔주자. 나는 <code>"ISSUE##{iid}"</code> 로 심플하게 바꿨다.</p>
<p>이것만 바꾸면 &lsquo;Create New Branch&rsquo; 를 누를 때 잘 될 것 같다. 하지만 Issue 페이지에서 &lsquo;연관된 Issue Branch&rsquo; 목록에 연결되지 않는다. 수정한 파일 <code>/opt/gitlab/embedded/service/gitlab-rails/app/models/issue.rb</code> 에서, 더 수정할 것이 남아있다. 다음 함수를 수정해야 한다.</p>
<ul>
<li>has_related_branch</li>
<li>related_branches</li>
</ul>
<p>수정 방법은 간단한데, Branch와 비교하는 Regular Expression 의 문법을 찾아보자. <code>/\A${iid}-(?!\d+-stable)/i</code> 라고 되어 있을 것이다. 이걸 실제로 <code>irb</code> 에서 테스트해 보면, <code>420-title</code> 같은 건 되는데 <code>420-0-stable</code> 은 인식이 안 되는 것을 알 수 있다. (뭔가.. 이상하다) 아무튼 이걸 적절한 Regular Expression 으로 바꿔 주도록 하자. Ruby의 Regexp 에 익숙치 않다면 <a href=http://rubular.com/>이 사이트</a>의 도움을 받아보도록 하자. (내 경우는 간단하게 <code>/\AISSUE#{iid}/i</code> 라고 했다.)</p>
<p>수정을 했다. 하지만 끝이 아니다. 마무리를 해 줘야 한다. 실제 Gitlab이 서비스되고 있는 경로는 <code>/var/opt/gitlab</code> 이므로, 해당 경로로 적용을 시켜줘야 한다. 어떻게?</p>
<p>간단하다. <code>gitlab-ctl reconfigure && gitlab-ctl restart</code> 를 입력하자.</p>
<p> </p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://interp.blog/tags/gitlab/>gitlab</a></li>
<li><a href=https://interp.blog/tags/ci/>ci</a></li>
</ul>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://interp.blog/>InterP Blog</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>